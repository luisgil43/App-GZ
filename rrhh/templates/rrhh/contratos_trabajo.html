{% extends 'dashboard/base.html' %}

{% block content %}
<div class="bg-white shadow mt-3 -mx-3 sm:mx-0 rounded-none sm:rounded-2xl px-3 py-4 sm:p-6">
  <h1 class="text-2xl font-bold text-gray-800 mb-4">
    ðŸ“‘ Mis Contratos de Trabajo
  </h1>

   <div class="overflow-x-auto">
    <table class="table-auto w-full text-sm min-w-full sm:min-w-[1200px]" style="white-space: nowrap;">
     <thead class="bg-gray-100 text-gray-700 font-semibold">
  <tr>
    <th class="px-4 py-2 text-left">Fecha de Inicio</th>
    <th class="px-4 py-2 text-left">Fecha de TÃ©rmino</th>
    <th class="px-4 py-2 text-left">Status</th>
    <th class="px-4 py-2 text-left">Contrato Adjunto</th>
  </tr>
</thead>
<tbody class="divide-y divide-gray-300 text-gray-800">
  {% for contrato in contratos %}
  <tr>
    <td class="px-4 py-2">{{ contrato.fecha_inicio }}</td>
    <td class="px-4 py-2">
      {% if contrato.fecha_termino %}
        {{ contrato.fecha_termino|date:"j \\d\\e F \\d\\e Y" }}
      {% else %}
        Indefinido
      {% endif %}
    </td>

    {# === STATUS PARA EL USUARIO === #}
    <td class="px-4 py-2">
      {% if contrato.status_code == 'vencido' %}
        <span class="inline-block px-3 py-1 rounded-full bg-red-100 text-red-800 text-xs font-semibold">
          Contrato vencido
        </span>
      {% elif contrato.status_code == 'por_vencer' %}
        <span class="inline-block px-3 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-semibold">
          Tu contrato vence en {{ contrato.dias_restantes }} dÃ­as
        </span>
      {% elif contrato.status_code == 'vigente' %}
        <span class="inline-block px-3 py-1 rounded-full bg-emerald-100 text-emerald-800 text-xs font-semibold">
          Contrato vigente
        </span>
      {% else %}
        <span class="inline-block px-3 py-1 rounded-full bg-gray-100 text-gray-700 text-xs font-semibold">
          Indefinido
        </span>
      {% endif %}
    </td>

    <td class="px-4 py-2">
      {% if contrato.archivo %}
        <a href="{{ contrato.archivo.url }}" class="text-blue-600" target="_blank">
          ðŸ“„ <span class="underline ml-1">Ver contrato</span>
        </a>
      {% else %}
        <span class="text-gray-400 italic">No adjunto</span>
      {% endif %}
    </td>
  </tr>
  {% empty %}
  <tr>
    <td colspan="4" class="px-4 py-6 text-center text-gray-500">
      No tienes contratos registrados.
    </td>
  </tr>
  {% endfor %}
</tbody>
    </table>
  </div>
</div>
{% endblock %}