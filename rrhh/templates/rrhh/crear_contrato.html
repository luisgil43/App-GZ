{% extends "dashboard_admin/base.html" %}

{% block dashboard_content %}
<div class="p-6 max-w-2xl mx-auto">
  <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
    âž• Crear Contrato de Trabajo
  </h2>

  <form method="POST" enctype="multipart/form-data" class="space-y-6 bg-white p-6 rounded-xl shadow">
    {% csrf_token %}
    {{ form.non_field_errors }}

    <!-- TÃ©cnico -->
    <div>
      <label for="id_tecnico" class="block font-medium text-gray-700 mb-1">TÃ©cnico</label>
      {{ form.tecnico }}
      {% if form.tecnico.errors %}
        <p class="mt-1 text-sm text-red-600">{{ form.tecnico.errors.0 }}</p>
      {% endif %}
    </div>

    <!-- Fecha inicio -->
    <div>
      <label for="id_fecha_inicio" class="block font-medium text-gray-700 mb-1">Fecha de Inicio</label>
      {{ form.fecha_inicio }}
      {% if form.fecha_inicio.errors %}
        <p class="mt-1 text-sm text-red-600">{{ form.fecha_inicio.errors.0 }}</p>
      {% endif %}
    </div>

    <!-- Fecha tÃ©rmino + indefinido -->
    <div>
      <label for="id_fecha_termino" class="block font-medium text-gray-700 mb-1">Fecha de TÃ©rmino</label>
      <div class="flex items-center gap-4">
        {{ form.fecha_termino }}
        {% if form.fecha_termino.errors %}
          <p class="mt-1 text-sm text-red-600">{{ form.fecha_termino.errors.0 }}</p>
        {% endif %}

        <label class="inline-flex items-center gap-2">
          <input
            type="checkbox"
            id="indefinido"
            name="indefinido-check"
            class="form-checkbox rounded text-emerald-600"
          >
          <span class="text-sm text-gray-600">Indefinido</span>
        </label>
      </div>
    </div>

    <!-- Archivo PDF -->
    <div>
      <label for="id_archivo" class="block font-medium text-gray-700 mb-1">
        Archivo PDF del Contrato
      </label>
      {{ form.archivo }}
      {% if form.archivo.errors %}
        <p class="mt-1 text-sm text-red-600">{{ form.archivo.errors.0 }}</p>
      {% endif %}
    </div>

    <!-- Checkbox reemplazar_archivo no es necesario en crear, pero si lo quieres: -->
    {# {{ form.reemplazar_archivo }} se puede ocultar o no usar en crear #}

    <!-- Botones -->
    <div class="flex flex-col sm:flex-row gap-4">
      <button
        type="submit"
        class="bg-emerald-600 text-white px-4 py-2 rounded hover:bg-emerald-700 w-full sm:w-auto">
        ðŸ’¾ Guardar Contrato
      </button>
      <a
        href="{% url 'rrhh:contratos_trabajo' %}"
        class="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400 text-center w-full sm:w-auto">
        ðŸ”™ Volver
      </a>
    </div>
  </form>
</div>

<script>
  const indefinidoCheckbox = document.getElementById('indefinido');
  const fechaTerminoInput  = document.getElementById('id_fecha_termino');

  function toggleFechaTermino() {
    if (!fechaTerminoInput) return;
    if (indefinidoCheckbox.checked) {
      fechaTerminoInput.disabled = true;
      fechaTerminoInput.value = '';
    } else {
      fechaTerminoInput.disabled = false;
    }
  }

  if (indefinidoCheckbox) {
    indefinidoCheckbox.addEventListener('change', toggleFechaTermino);
  }
  window.addEventListener('DOMContentLoaded', toggleFechaTermino);
</script>
{% endblock %}