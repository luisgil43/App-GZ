{% extends "dashboard_admin/base.html" %}
{% block title %}Configurar Notificaciones{% endblock %}

{% block dashboard_content %}
<div class="w-full flex justify-center">
  <div class="bg-white shadow mt-3 -mx-3 sm:mx-0 rounded-none sm:rounded-2xl px-3 py-4 sm:p-6 w-full max-w-2xl">

    <div class="flex items-center justify-between gap-2 mb-4">
      <h2 class="text-2xl font-bold text-gray-800">üîî Notificaciones - {{ vehicle.patente }}</h2>
      <a href="{% url 'flota:notification_list' %}"
         class="px-4 py-2 rounded-full text-sm border bg-white hover:bg-gray-50">
        ‚Üê Volver
      </a>
    </div>

    <div class="p-3 rounded-xl border bg-gray-50 text-sm text-gray-700 mb-4">
      <div class="font-semibold mb-1">‚ÑπÔ∏è Chofer asignado</div>
      {% if assigned_email %}
        Se detect√≥ correo del chofer asignado: <b>{{ assigned_email }}</b>
      {% else %}
        No hay chofer asignado con correo disponible.
      {% endif %}
    </div>

    <form method="post" class="space-y-4">
      {% csrf_token %}

      {% if form.non_field_errors %}
        <div class="p-3 rounded-lg bg-red-100 text-red-800 text-sm">
          {{ form.non_field_errors }}
        </div>
      {% endif %}

      <div class="flex items-center gap-2">
        {{ form.enabled }}
        <label class="text-sm font-semibold text-gray-700">{{ form.enabled.label }}</label>
      </div>
      {% if form.enabled.errors %}
        <div class="text-xs text-red-600">{{ form.enabled.errors }}</div>
      {% endif %}

      <div class="flex items-center gap-2">
        {{ form.include_assigned_driver }}
        <label class="text-sm font-semibold text-gray-700">{{ form.include_assigned_driver.label }}</label>
      </div>
      {% if form.include_assigned_driver.errors %}
        <div class="text-xs text-red-600">{{ form.include_assigned_driver.errors }}</div>
      {% endif %}

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">{{ form.extra_emails_to.label }}</label>
        {{ form.extra_emails_to }}
        {% if form.extra_emails_to.help_text %}
          <div class="text-xs text-gray-500 mt-1">{{ form.extra_emails_to.help_text }}</div>
        {% endif %}
        {% if form.extra_emails_to.errors %}
          <div class="text-xs text-red-600 mt-1">{{ form.extra_emails_to.errors }}</div>
        {% endif %}
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-1">{{ form.extra_emails_cc.label }}</label>
        {{ form.extra_emails_cc }}
        {% if form.extra_emails_cc.help_text %}
          <div class="text-xs text-gray-500 mt-1">{{ form.extra_emails_cc.help_text }}</div>
        {% endif %}
        {% if form.extra_emails_cc.errors %}
          <div class="text-xs text-red-600 mt-1">{{ form.extra_emails_cc.errors }}</div>
        {% endif %}
      </div>

      <div class="flex justify-end gap-2 pt-2">
        <a href="{% url 'flota:notification_list' %}"
           class="px-4 py-2 rounded-full text-sm border bg-white hover:bg-gray-50">
          Cancelar
        </a>
        <button type="submit"
                class="px-4 py-2 rounded-full text-sm bg-blue-600 text-white hover:bg-blue-700">
          Guardar
        </button>
      </div>
    </form>
  </div>
</div>

<script>
  document.querySelectorAll('input, select, textarea').forEach(el=>{
    if (el.type === 'checkbox') {
      el.classList.add('h-5','w-5','rounded','border-gray-300');
    } else {
      el.classList.add('w-full','border','rounded-xl','px-3','py-2','text-sm');
    }
  });
</script>
{% endblock %}